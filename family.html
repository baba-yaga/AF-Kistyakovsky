<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Семья Александра Ф. Кистяковского</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <div id="page-top" class="sr-only" aria-hidden="true"></div>

  <div class="top-nav" id="top">
    <div class="container nav-inner">
      <a class="brand" href="index.html#page-top">А.&nbsp;Ф. Кистяковский</a>
      <nav class="nav-links" aria-label="Основное меню">
        <a href="#sons" class="is-active">Сыновья</a>
        <a href="#resources">Материалы</a>
      </nav>
    </div>
  </div>

  <header class="container">
    <div class="paper">
      <div class="grain"></div>
      <div class="container hero">
        <div>
          <h1 class="reveal">Семья Александра&nbsp;Ф. Кистяковского</h1>
          <p class="lead reveal">
            Александра Ивановна и её шесть сыновей — династия гуманистов, учёных и общественных деятелей.
          </p>
        </div>
        <figure class="frame float sepia">
          <img src="assets/images/alexandra_and_six_sons_ps.jpg" alt="Александра Ивановна Кистяковская с шестью сыновьями" />
          <figcaption class="caption">Александра&nbsp;Ивановна Кистяковская и сыновья. Около 1900 года.</figcaption>
        </figure>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="sons" class="section">
      <h2>Шесть сыновей — шесть историй</h2>
      <p style="color:var(--muted);max-width:640px">Каждый портрет открывает краткую справку и ведёт на отдельную страницу с биографией и источниками.</p>
      <div class="sons">
        <a class="son" href="#" data-son-id="Kistyakovsky_Vladimir_Alexandrovich" data-occupation="Химик, академик" data-known-for="Основатель электрохимии в России">
          <figure class="portrait sepia">
            <img src="assets/images/vladimir_alexandrovich_kistyakovsky.jpg" alt="Владимир Кистяковский" loading="lazy" />
          </figure>
          <h3 style="margin:10px 0 4px;font-size:18px">Владимир Кистяковский</h3>
          <small>1865-1952</small>
        </a>
        <a class="son" href="#" data-son-id="Kistyakovsky_Bogdan_Alexandrovich" data-occupation="Философ, социолог, правовед" data-known-for="Один из авторов сборника «Вехи»">
          <figure class="portrait sepia">
            <img src="assets/images/bogdan_alexandrovich_kistyakovsky.jpg" alt="Богдан Кистяковский" loading="lazy" />
          </figure>
          <h3 style="margin:10px 0 4px;font-size:18px">Богдан Кистяковский</h3>
          <small>1868—1920</small>
        </a>
        <a class="son" href="#" data-son-id="Kistyakovsky_Yuly_Alexandrovich" data-occupation="Юрист, общественный деятель" data-known-for="Сын известного правоведа">
          <figure class="portrait sepia">
            <img src="assets/images/yuly_alexandrovich_kistyakovsky.jpg" alt="Юлий Кистяковский" loading="lazy" />
          </figure>
          <h3 style="margin:10px 0 4px;font-size:18px">Юлий Кистяковский</h3>
          <small>1872-1920</small>
        </a>
        <a class="son" href="#" data-son-id="Kistyakovsky_Alexander_Alexandrovich" data-occupation="Юрист, общественный деятель" data-known-for="Сын известного правоведа">
          <figure class="portrait sepia">
            <img src="assets/images/alexandr_alexandrovich_kistyakovsky.jpg" alt="Александр Кистяковский" loading="lazy" />
          </figure>
          <h3 style="margin:10px 0 4px;font-size:18px">Александр Кистяковский</h3>
          <small>1874-1923</small>
        </a>
        <a class="son" href="#" data-son-id="Kistyakovsky_Boris_Alexandrovich" data-occupation="Философ, социолог, правовед" data-known-for="Автор работ по философии права и социологии">
          <figure class="portrait sepia">
            <img src="assets/images/boris_alexandrovich_kistyakovsky.jpg" alt="Борис Кистяковский" loading="lazy" />
          </figure>
          <h3 style="margin:10px 0 4px;font-size:18px">Борис Кистяковский</h3>
          <small>1876-1940</small>
        </a>
        <a class="son" href="#" data-son-id="Kistyakovsky_Igor_Alexandrovich" data-occupation="Юрист, государственный деятель" data-known-for="Министр внутренних дел Украинской Державы">
          <figure class="portrait sepia">
            <img src="assets/images/igor_alexandrovich_kistyakovsky.jpg" alt="Игорь Кистяковский" loading="lazy" />
          </figure>
          <h3 style="margin:10px 0 4px;font-size:18px">Игорь Кистяковский</h3>
          <small>1876-1940</small>
        </a>
      </div>
    </section>

    <section id="resources" class="section">
      <div class="paper">
        <div class="grain"></div>
        <div class="container" style="padding:22px 26px">
          <h2>Материалы и ссылки</h2>
          <p>Подборка ресурсов для углублённого изучения семьи Кистяковских.</p>
          <div class="cluster" style="margin:18px 0">
            <a class="btn btn--primary" href="https://www.geni.com/people/%D0%90%D0%BB%D0%B5%D0%BA%D1%81%D0%B0%D0%BD%D0%B4%D1%80-%D0%9A%D0%B8%D1%81%D1%82%D1%8F%D0%BA%D0%BE%D0%B2%D1%81%D0%BA%D0%B8%D0%B9/6000000018972375013" target="_blank" rel="noopener">Генеалогическое древо на Geni.com</a>
            <a class="btn btn--primary" href="index.html#bio">Назад к биографии</a>
          </div>
          <ul class="resource-list">
            <li><span class="dot">•</span><a href="Kistyakovsky_Vladimir_Alexandrovich/index.html">Владимир Кистяковский — подробная биография</a></li>
            <li><span class="dot">•</span><a href="Kistyakovsky_Bogdan_Alexandrovich/index.html">Богдан Кистяковский — философ и правовед</a></li>
            <li><span class="dot">•</span><a href="Kistyakovsky_Boris_Alexandrovich/index.html">Борис Кистяковский — интеллектуал «Вех»</a></li>
            <li><span class="dot">•</span><a href="Kistyakovsky_Igor_Alexandrovich/index.html">Игорь Кистяковский — государственный деятель</a></li>
            <li><span class="dot">•</span><a href="Kistyakovsky_Alexander_Alexandrovich/index.html">Александр Кистяковский — юрист и общественник</a></li>
            <li><span class="dot">•</span><a href="Kistyakovsky_Yuly_Alexandrovich/index.html">Юлий Кистяковский — юрист просветитель</a></li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer>© Страница о наследии А.&nbsp;Ф. Кистяковского </footer>

  <div id="son-modal" class="modal" aria-hidden="true" role="dialog">
    <div class="modal-content paper">
      <button class="modal-close" aria-label="Закрыть">×</button>
      <div class="modal-body"></div>
    </div>
  </div>

  <script>
    const sonModal = document.getElementById('son-modal');
    const modalCloseButton = sonModal.querySelector('.modal-close');
    const modalBody = sonModal.querySelector('.modal-body');

    document.querySelectorAll('.son').forEach(card => {
      card.addEventListener('click', async (e) => {
        e.preventDefault();

        const sonId = card.dataset.sonId;
        const sonName = card.querySelector('h3').textContent;
        const sonLifespan = card.querySelector('small').textContent;
        const sonImageSrc = card.querySelector('img').getAttribute('src');
        const sonImageAlt = card.querySelector('img').getAttribute('alt');
        const sonOccupation = card.dataset.occupation;
        const sonKnownFor = card.dataset.knownFor;
        const fullPageLink = `${sonId}/index.html`;
        const sonSlug = sonId.split('_')[1].toLowerCase();

        let detailsHtml = '<p>Не удалось загрузить дополнительные сведения.</p>';

        try {
          const response = await fetch(`assets/sons/${sonSlug}.html`);
          if (response.ok) {
            detailsHtml = await response.text();
          }
        } catch (error) {
          console.error('Ошибка загрузки деталей сына:', error);
        }

        modalBody.innerHTML = `
          <div class="son-popup-content">
            <div class="son-popup-text">
              <h3 style="margin-top:.5rem">${sonName}</h3>
              <p class="lead">${sonLifespan}</p>
              <ul class="facts">
                <li><span class="dot">•</span><span>Род занятий: ${sonOccupation}</span></li>
                <li><span class="dot">•</span><span>Известен как: ${sonKnownFor}</span></li>
              </ul>
              <div class="cluster">
                <a class="btn btn--primary" href="${fullPageLink}">Подробнее</a>
              </div>
              <div class="modal-content-text">${detailsHtml}</div>
            </div>
            <figure class="frame sepia son-popup-image">
              <img src="${sonImageSrc}" alt="${sonImageAlt}" />
              <figcaption class="caption">${sonName} — портрет</figcaption>
            </figure>
          </div>
        `;

        sonModal.querySelector('.modal-content').setAttribute('aria-label', sonName);
        sonModal.setAttribute('aria-hidden', 'false');
        sonModal.classList.add('is-open');
        document.body.style.overflow = 'hidden';
        modalBody.scrollTop = 0;
      });
    });

    modalCloseButton.addEventListener('click', () => {
      sonModal.setAttribute('aria-hidden', 'true');
      sonModal.classList.remove('is-open');
      document.body.style.overflow = '';
      modalBody.innerHTML = '';
    });

    sonModal.addEventListener('click', (e) => {
      if (e.target === sonModal) {
        modalCloseButton.click();
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && sonModal.classList.contains('is-open')) {
        modalCloseButton.click();
      }
    });

    const sections = document.querySelectorAll('main section');
    const navLinks = document.querySelectorAll('.nav-links a[href^="#"]');

    if (sections.length && navLinks.length) {
      const observerOptions = { root: null, rootMargin: '0px', threshold: 0.5 };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            navLinks.forEach(link => {
              link.classList.toggle('is-active', link.getAttribute('href') === `#${entry.target.id}`);
            });
          }
        });
      }, observerOptions);

      sections.forEach(section => observer.observe(section));
    }
  </script>
</body>
</html>
